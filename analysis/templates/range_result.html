{% extends "base.html" %}

{% block title %}
    Range Result
{% endblock %}

{% block body %}
    <h1>Range results</h1>

    <div id="chart-with-lines-new"></div>

    <div id="chart-with-lines">
        <h2>Chart With Lines</h2>
        <svg></svg>
    </div>


    <div id="chart_values">
        <h2>Values</h2>
        <svg></svg>
    </div>

    <div id="chart_histogram">
        <h2>Histogram</h2>
        <svg></svg>
    </div>

    <div>
        <h2>Statistics</h2>
        <table id="range_statistics" class="display">
            <thead>
            <tr>
                <th>Measure</th>
                <th>Value</th>
            </tr>
            </thead>
            <tbody>
            {% for measure, value in result.statistics.items %}
                <tr>
                    <td>{{ measure }}</td>
                    <td>{{ value }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block javascript %}
    <script type="text/javascript">
    range_data_values = ['data1'];
    curve_values = ['data2'];

    range_data_values += {{ values|safe }};
    curve_values += {{ curve_values|safe }};

        var chart = c3.generate({
            bindto: '#chart-with-lines-new',
            data: {
                columns: [
                    range_data_values,
                    // Uncomment to show lines
                    //curve_values
                ],
                type: 'bar',
                types: {
                    data2: 'spline'
                }
            }
        });
   </script>

    <script type="text/javascript">
        range_data_values = {{ result.values|safe }}

                nv.addGraph(function () {
                    var chart_values = nv.models.discreteBarChart()
                            .x(function (d) {
                                return d.label
                            })
                            .y(function (d) {
                                return d.value
                            })
                            .staggerLabels(true)
                            .tooltips(false)
                            .showValues(true)

                    d3.select('#chart_values svg')
                            .datum(range_data_values)
                            .transition()
                            .duration(500)
                            .call(chart_values)
                    ;

                    nv.utils.windowResize(chart_values.update);

                    return chart_values;
                });
    </script>

    <script type="text/javascript">
        range_data_histogram = {{ result.histogram|safe }}

                nv.addGraph(function () {
                    var chart_histogram = nv.models.discreteBarChart()
                            .x(function (d) {
                                return d.label
                            })
                            .y(function (d) {
                                return d.value
                            })
                            .staggerLabels(true)
                            .tooltips(false)
                            .showValues(true)

                    d3.select('#chart_histogram svg')
                            .datum(range_data_histogram)
                            .transition()
                            .duration(500)
                            .call(chart_histogram)
                    ;

                    nv.utils.windowResize(chart_histogram.update);

                    return chart_histogram;
                });
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#range_statistics').dataTable();
        });
    </script>
{% endblock %}