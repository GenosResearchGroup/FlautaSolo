{% extends "base.html" %}

{% block title %}
    Test D3
{% endblock %}


{% block body %}
    <h1>D3 Test</h1>

    <div id="chart">
        <svg></svg>
    </div>
{% endblock %}

{% block style %}
    <style>
        #chart svg {
            height: 400px;
        }
    </style>
{% endblock %}

{% block javascript %}
    <script>
        d3.json("/ajax/range-data/", function (error, data) {
            nv.addGraph(function () {
                nv.addGraph(function () {
                    var chart = nv.models.discreteBarChart()
                            .x(function (d) {
                                return d.label
                            })
                            .y(function (d) {
                                return d.value
                            })
                            .staggerLabels(true)
                            .tooltips(false)
                            .showValues(true)

                    d3.select('#chart svg')
                            .datum(data)
                            .transition().duration(500)
                            .call(chart)
                    ;

                    nv.utils.windowResize(chart.update);
                    return chart;
                });
            });
        });
    </script>
{% endblock %}
